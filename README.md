# Methods in AI Research | Dialogue Act Classifier

This project implements and evaluates several machine learning models for classifying dialogue acts in a restaurant-domain dataset.

## Install requirements
```bash
pip install -r requirements.txt
```

## Run script
```bash
py main.py
```
This will run the full pipeline, including training, testing and user interaction. Some training results are cached in the repository for efficiency.

## File Descriptions

- **`requirements.txt`**: Lists all the Python packages required to run this project.
- **`main.py`**: The main entry point for the project. It orchestrates the entire workflow of data loading, model training, and launching the interactive command-line interface.
- **`cli.py`**: Defines the `start_cli` function, which provides an interactive prompt for users to classify their own sentences using the trained models.
- **`data.py`**: Contains functions related to data loading and preparation.
  - `load_and_preprocess_data()`: Loads the raw `dialog_acts.dat` file, cleans the data by handling utterances which were fully unintelligible and rows with null labels, and converts it to a pandas DataFrame.
  - `split_data()`: Splits the DataFrame into training (75%), validation (10%), and test sets (15%).
- **`models/baseline_systems.py`**: Implements baseline classification systems including majority baseline and rule-based baseline for comparison with machine learning models.
- **`models/logistic_regression.py`**: Contains the implementation for Classifier 1 (Logistic Regression) with hyperparameter optimization using Optuna.
- **`models/multinomial_naive_bayes.py`**: Contains the implementation for Classifier 2 (Multinomial Naive Bayes) with hyperparameter optimization.
- **`models/svm.py`**: Contains the implementation for Classifier 3 (Support Vector Machine). It uses the Optuna library to perform efficient hyperparameter optimization and caches the results to a `.pkl` file to save time on subsequent runs. Function used to avoid repetition when training the 2 SVM's.
- **`models/decision_tree.py`**: Contains the implementation for Classifier 4 (Decision Tree) with hyperparameter optimization.
- **`optuna_study_svm_*.pkl`**: These are cached result files generated by `svm.py` after running the hyperparameter optimization. You can safely delete them to force the optimization to run again.

- **`dialogue_system/restaurant.py`**: Defines the `Restaurant` data class that represents a restaurant with attributes like name, price range, area, food type, phone, address, and postcode.
- **`dialogue_system/restaurant_reader.py`**: Handles loading restaurant data from CSV files and converting them into `Restaurant` objects for use by the dialogue system.
- **`dialogue_system/restaurant_manager.py`**: Manages the restaurant database by extracting unique values for each attribute (area, food type, price range) and provides methods to retrieve available options for each category.
- **`dialogue_system/keyword_searcher.py`**: Implements natural language processing for extracting user preferences from utterances. Uses two strategies: keyword-based Levenshtein distance matching and TF-IDF cosine similarity as a fallback.
- **`dialogue_system/transitions_and_states.py`**: Defines the finite state machine for restaurant recommendation dialogues, including states (welcome, ask_area, ask_food, etc.), user acts (inform, affirm, deny, etc.), and transition logic between states.
- **`finite_state_machine_initializor.py`**: Advanced state machine implementation that integrates machine learning models with the dialogue system. Creates an interactive FSM that uses trained ML models to classify user input, extracts preferences using keyword search, and manages conversation flow through defined states and transitions.
- **`Transition_states.py`**: Core finite state machine framework that defines the FSM architecture. Contains the base classes for Context (tracks user preferences), Action (dialog act types), State (conversation states with actions), Transition (state transitions with triggers), and FSM (main state machine controller that manages state flow and ML model integration).


- **`data/dialog_acts.dat`**: The main dataset containing dialogue acts and utterances for training the classification models.
- **`data/restaurant_info.csv`**: Restaurant database containing information about 110 restaurants including their names, price ranges, areas, food types, phone numbers, addresses, and postcodes.

- **`utils/csv_reader.py`**: Utility class for reading CSV files, used by the restaurant reader component.
- **`utils/stats_retriever.py`**: Provides functionality for collecting and displaying system performance statistics and results comparison.
- 
- **`StateDiagram.jpg.py`**: Shows a diagram of all the states and transitions the system has.


## Contributions

| Team Member | Tasks                                                                                                              |
|-------------|--------------------------------------------------------------------------------------------------------------------|
| Bram        | Classifier 1 (Logistic Regression) + State Diagram + States & Transitions + Updated ReadMe for Part 1b             |
| Lenny       | Classifier 2 (Naive Multinomial Bayes) + States & Transitions                                                      |
| Shady       | Data Preprocessing + Classifier 3 (SVM) + CLI + Feedback 1A (Refactoring) + Restaurant Lookup Funtion              |
| Dirk-Jan    | Baseline Systems + Classifier Decision Tree + Evaluation + State Diagram + States & Transitions + keyword matching |

